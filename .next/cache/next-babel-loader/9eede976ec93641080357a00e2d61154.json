{"ast":null,"code":"import _defineProperty from \"@babel/runtime-corejs2/helpers/esm/defineProperty\";\nimport _Object$assign from \"@babel/runtime-corejs2/core-js/object/assign\";\nimport _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\nimport _classCallCheck from \"@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _possibleConstructorReturn from \"@babel/runtime-corejs2/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime-corejs2/helpers/esm/getPrototypeOf\";\nimport _createClass from \"@babel/runtime-corejs2/helpers/esm/createClass\";\nimport _inherits from \"@babel/runtime-corejs2/helpers/esm/inherits\";\nimport _JSXStyle from \"styled-jsx/style\";\nvar __jsx = React.createElement;\nimport React from 'react';\nimport * as superagent from 'superagent';\n\nvar _default =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(_default, _React$Component);\n\n  _createClass(_default, null, [{\n    key: \"getInitialProps\",\n    value: function getInitialProps(_ref) {\n      var req, hostname, baseUrl, db, _list, _ref2, list;\n\n      return _regeneratorRuntime.async(function getInitialProps$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              req = _ref.req;\n              hostname = req ? \"\".concat(req.protocol, \"://\").concat(req.get('Host')) : '';\n              baseUrl = \"\".concat(hostname, \"/api\");\n\n              if (!req) {\n                _context.next = 9;\n                break;\n              }\n\n              db = req.db;\n              _context.next = 7;\n              return _regeneratorRuntime.awrap(db.collection('Registrations').find().sort({\n                createdAt: -1\n              }).toArray());\n\n            case 7:\n              _list = _context.sent;\n              return _context.abrupt(\"return\", {\n                list: _list\n              });\n\n            case 9:\n              _context.next = 11;\n              return _regeneratorRuntime.awrap(superagent.get(baseUrl).then(function (res) {\n                return res.body;\n              }));\n\n            case 11:\n              _ref2 = _context.sent;\n              list = _ref2.list;\n              return _context.abrupt(\"return\", {\n                list: list,\n                baseUrl: baseUrl\n              });\n\n            case 14:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      });\n    }\n  }]);\n\n  function _default() {\n    var _this;\n\n    _classCallCheck(this, _default);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(_default).call(this));\n    _this.state = {\n      formData: {\n        author: '',\n        title: ''\n      }\n    };\n    return _this;\n  }\n\n  _createClass(_default, [{\n    key: \"setForm\",\n    value: function setForm(prop) {\n      var _this2 = this;\n\n      return function (ev) {\n        var state = _this2.state || {};\n        var formData = state.formData || {};\n\n        _this2.setState(_Object$assign({}, state, {\n          formData: _Object$assign({}, formData, _defineProperty({}, prop, ev.target.value))\n        }));\n      };\n    }\n  }, {\n    key: \"isFormInvalid\",\n    value: function isFormInvalid() {\n      var state = this.state || {};\n      var formData = state.formData || {};\n      return !formData.author || !formData.title;\n    }\n  }, {\n    key: \"remove\",\n    value: function remove(_id) {\n      var _this3 = this;\n\n      return function (ev) {\n        superagent.del(\"\".concat(_this3.props.baseUrl, \"/\").concat(_id)).then(function () {\n          var state = _this3.state || {};\n          var list = _this3.state.list || _this3.props.list || [];\n\n          _this3.setState(_Object$assign({}, state, {\n            list: list.filter(function (book) {\n              return book._id !== _id;\n            })\n          }));\n        })[\"catch\"](function (error) {\n          return console.error(error.stack);\n        });\n      };\n    }\n  }, {\n    key: \"add\",\n    value: function add() {\n      var _this4 = this;\n\n      return function (ev) {\n        ev.preventDefault();\n        var state = _this4.state || {};\n        var formData = state.formData || {};\n\n        _this4.setState(_Object$assign({}, _this4.state, {\n          formData: {\n            author: '',\n            title: ''\n          }\n        }));\n\n        superagent.post(_this4.props.baseUrl, formData).then(function (res) {\n          var state = _this4.state || {};\n          var list = _this4.state.list || _this4.props.list || [];\n\n          _this4.setState(_Object$assign({}, state, {\n            list: [res.body.book].concat(list)\n          }));\n        })[\"catch\"](function (error) {\n          return console.error(error.stack);\n        });\n      };\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this5 = this;\n\n      var list = this.state.list || this.props.list;\n      var formData = this.state.formData;\n      return __jsx(\"div\", {\n        id: \"container\",\n        className: \"jsx-2512804896\"\n      }, __jsx(\"h1\", {\n        className: \"jsx-2512804896\"\n      }, \"New Book\"), __jsx(\"div\", {\n        id: \"input-book\",\n        className: \"jsx-2512804896\"\n      }, __jsx(\"form\", {\n        onSubmit: this.add(),\n        className: \"jsx-2512804896\"\n      }, __jsx(\"input\", {\n        type: \"text\",\n        onChange: this.setForm('title'),\n        value: formData.title,\n        placeholder: \"Title\",\n        className: \"jsx-2512804896\"\n      }), __jsx(\"input\", {\n        type: \"text\",\n        onChange: this.setForm('author'),\n        value: formData.author,\n        placeholder: \"Author\",\n        className: \"jsx-2512804896\"\n      }), __jsx(\"button\", {\n        disabled: this.isFormInvalid(),\n        className: \"jsx-2512804896\"\n      }, \"Add\"))), __jsx(\"h1\", {\n        className: \"jsx-2512804896\"\n      }, \"Reading List\"), __jsx(\"div\", {\n        id: \"reading-list\",\n        className: \"jsx-2512804896\"\n      }, __jsx(\"ul\", {\n        className: \"jsx-2512804896\"\n      }, list.map(function (book) {\n        return __jsx(\"div\", {\n          key: book._id,\n          className: \"jsx-2512804896\"\n        }, __jsx(\"span\", {\n          onClick: _this5.remove(book._id),\n          className: \"jsx-2512804896\" + \" \" + \"remove\"\n        }, \"\\xD7\"), \"\\xA0\", __jsx(\"span\", {\n          className: \"jsx-2512804896\" + \" \" + \"description\"\n        }, __jsx(\"i\", {\n          className: \"jsx-2512804896\"\n        }, book.title), \" by \", book.author));\n      }))), __jsx(_JSXStyle, {\n        id: \"2512804896\"\n      }, \"div.jsx-2512804896{font-family:'Helvetica','sans-serif';}#container.jsx-2512804896{width:800px;margin-left:auto;margin-right:auto;}h1.jsx-2512804896{color:#ccbc1d;}button.jsx-2512804896{background-color:#ff257b;color:#ffffff;font-weight:bold;border:0px;border-radius:2px;padding:5px;padding-left:8px;padding-right:8px;margin:5px;}input.jsx-2512804896{padding:5px;border:0px;background-color:#f0f0f0;margin:5px;}.description.jsx-2512804896{position:relative;top:-0.2em;}.remove.jsx-2512804896{cursor:pointer;color:#ff257b;font-size:1.5em;}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9zdGVmYW5mcmFuY2lzL1BlcnNvbmFsL3dvcmsvcGFreW8tYmFja2VuZC9wYWdlcy9pbmRleC5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUF1SG9CLEFBR21ELEFBRzFCLEFBS0UsQUFHVyxBQVdiLEFBTU0sQUFJSCxZQTVCRSxBQW1CTixFQWRiLENBd0JnQixHQUpILEtBTGMsRUFaWCxJQVBJLEFBeUJwQixBQUlrQixRQWpDbEIsRUFZbUIsTUFzQm5CLEVBN0JBLENBbUJhLFFBWEEsR0FZYixRQVhvQixrQkFDTixZQUNLLGlCQUNDLGtCQUNQLFdBQ2IiLCJmaWxlIjoiL1VzZXJzL3N0ZWZhbmZyYW5jaXMvUGVyc29uYWwvd29yay9wYWt5by1iYWNrZW5kL3BhZ2VzL2luZGV4LmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFJlYWN0IGZyb20gJ3JlYWN0J1xuaW1wb3J0ICogYXMgc3VwZXJhZ2VudCBmcm9tICdzdXBlcmFnZW50J1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBleHRlbmRzIFJlYWN0LkNvbXBvbmVudCB7XG4gIHN0YXRpYyBhc3luYyBnZXRJbml0aWFsUHJvcHMgKHsgcmVxIH0pIHtcbiAgICBjb25zdCBob3N0bmFtZSA9IHJlcSA/IGAke3JlcS5wcm90b2NvbH06Ly8ke3JlcS5nZXQoJ0hvc3QnKX1gIDogJyc7XG4gICAgY29uc3QgYmFzZVVybCA9IGAke2hvc3RuYW1lfS9hcGlgO1xuICAgIGlmIChyZXEpIHtcbiAgICAgIGNvbnN0IHsgZGIgfSA9IHJlcVxuICAgICAgY29uc3QgbGlzdCA9IGF3YWl0IGRiLmNvbGxlY3Rpb24oJ1JlZ2lzdHJhdGlvbnMnKS5maW5kKCkuc29ydCh7IGNyZWF0ZWRBdDogLTEgfSlcbiAgICAgICAgLnRvQXJyYXkoKVxuICAgICAgcmV0dXJuIHsgbGlzdCB9XG4gICAgfVxuXG4gICAgY29uc3QgeyBsaXN0IH0gPSBhd2FpdCBzdXBlcmFnZW50LmdldChiYXNlVXJsKVxuICAgICAgLnRoZW4ocmVzID0+IHJlcy5ib2R5KVxuICAgIHJldHVybiB7IGxpc3QsIGJhc2VVcmwgfVxuICB9XG5cbiAgY29uc3RydWN0b3IgKCkge1xuICAgIHN1cGVyKClcbiAgICB0aGlzLnN0YXRlID0geyBmb3JtRGF0YTogeyBhdXRob3I6ICcnLCB0aXRsZTogJycgfSB9XG4gIH1cblxuICBzZXRGb3JtIChwcm9wKSB7XG4gICAgcmV0dXJuIGV2ID0+IHtcbiAgICAgIGNvbnN0IHN0YXRlID0gdGhpcy5zdGF0ZSB8fCB7fVxuICAgICAgY29uc3QgZm9ybURhdGEgPSBzdGF0ZS5mb3JtRGF0YSB8fCB7fVxuICAgICAgdGhpcy5zZXRTdGF0ZShPYmplY3QuYXNzaWduKHt9LCBzdGF0ZSwge1xuICAgICAgICBmb3JtRGF0YTogT2JqZWN0LmFzc2lnbih7fSwgZm9ybURhdGEsIHtcbiAgICAgICAgICBbcHJvcF06IGV2LnRhcmdldC52YWx1ZVxuICAgICAgICB9KVxuICAgICAgfSkpO1xuICAgIH1cbiAgfVxuXG4gIGlzRm9ybUludmFsaWQgKCkge1xuICAgIGNvbnN0IHN0YXRlID0gdGhpcy5zdGF0ZSB8fCB7fVxuICAgIGNvbnN0IGZvcm1EYXRhID0gc3RhdGUuZm9ybURhdGEgfHwge31cbiAgICByZXR1cm4gIWZvcm1EYXRhLmF1dGhvciB8fCAhZm9ybURhdGEudGl0bGVcbiAgfVxuXG4gIHJlbW92ZSAoX2lkKSB7XG4gICAgcmV0dXJuIGV2ID0+IHtcbiAgICAgIHN1cGVyYWdlbnQuZGVsKGAke3RoaXMucHJvcHMuYmFzZVVybH0vJHtfaWR9YClcbiAgICAgICAgLnRoZW4oKCkgPT4ge1xuICAgICAgICAgIGNvbnN0IHN0YXRlID0gdGhpcy5zdGF0ZSB8fCB7fVxuICAgICAgICAgIGNvbnN0IGxpc3QgPSB0aGlzLnN0YXRlLmxpc3QgfHwgdGhpcy5wcm9wcy5saXN0IHx8IFtdXG4gICAgICAgICAgdGhpcy5zZXRTdGF0ZShPYmplY3QuYXNzaWduKHt9LCBzdGF0ZSwge1xuICAgICAgICAgICAgbGlzdDogbGlzdC5maWx0ZXIoYm9vayA9PiBib29rLl9pZCAhPT0gX2lkKVxuICAgICAgICAgIH0pKVxuICAgICAgICB9KVxuICAgICAgICAuY2F0Y2goZXJyb3IgPT4gY29uc29sZS5lcnJvcihlcnJvci5zdGFjaykpXG4gICAgfVxuICB9XG5cbiAgYWRkICgpIHtcbiAgICByZXR1cm4gZXYgPT4ge1xuICAgICAgZXYucHJldmVudERlZmF1bHQoKVxuICAgICAgY29uc3Qgc3RhdGUgPSB0aGlzLnN0YXRlIHx8IHt9XG4gICAgICBjb25zdCBmb3JtRGF0YSA9IHN0YXRlLmZvcm1EYXRhIHx8IHt9XG4gICAgICB0aGlzLnNldFN0YXRlKE9iamVjdC5hc3NpZ24oe30sIHRoaXMuc3RhdGUsIHtcbiAgICAgICAgZm9ybURhdGE6IHsgYXV0aG9yOiAnJywgdGl0bGU6ICcnIH1cbiAgICAgIH0pKVxuXG4gICAgICBzdXBlcmFnZW50LnBvc3QodGhpcy5wcm9wcy5iYXNlVXJsLCBmb3JtRGF0YSlcbiAgICAgICAgLnRoZW4ocmVzID0+IHtcbiAgICAgICAgICBjb25zdCBzdGF0ZSA9IHRoaXMuc3RhdGUgfHwge31cbiAgICAgICAgICBjb25zdCBsaXN0ID0gdGhpcy5zdGF0ZS5saXN0IHx8IHRoaXMucHJvcHMubGlzdCB8fCBbXVxuICAgICAgICAgIHRoaXMuc2V0U3RhdGUoT2JqZWN0LmFzc2lnbih7fSwgc3RhdGUsIHtcbiAgICAgICAgICAgIGxpc3Q6IFtyZXMuYm9keS5ib29rXS5jb25jYXQobGlzdClcbiAgICAgICAgICB9KSlcbiAgICAgICAgfSlcbiAgICAgICAgLmNhdGNoKGVycm9yID0+IGNvbnNvbGUuZXJyb3IoZXJyb3Iuc3RhY2spKVxuICAgIH1cbiAgfVxuXG4gIHJlbmRlciAoKSB7XG4gICAgY29uc3QgbGlzdCA9IHRoaXMuc3RhdGUubGlzdCB8fCB0aGlzLnByb3BzLmxpc3RcbiAgICBjb25zdCB7IGZvcm1EYXRhIH0gPSB0aGlzLnN0YXRlXG4gICAgcmV0dXJuIChcbiAgICAgIDxkaXYgaWQ9XCJjb250YWluZXJcIj5cbiAgICAgICAgPGgxPlxuICAgICAgICAgIE5ldyBCb29rXG4gICAgICAgIDwvaDE+XG4gICAgICAgIDxkaXYgaWQ9XCJpbnB1dC1ib29rXCI+XG4gICAgICAgICAgPGZvcm0gb25TdWJtaXQ9e3RoaXMuYWRkKCl9PlxuICAgICAgICAgICAgPGlucHV0XG4gICAgICAgICAgICAgIHR5cGU9XCJ0ZXh0XCJcbiAgICAgICAgICAgICAgb25DaGFuZ2U9e3RoaXMuc2V0Rm9ybSgndGl0bGUnKX1cbiAgICAgICAgICAgICAgdmFsdWU9e2Zvcm1EYXRhLnRpdGxlfVxuICAgICAgICAgICAgICBwbGFjZWhvbGRlcj1cIlRpdGxlXCIgLz5cbiAgICAgICAgICAgIDxpbnB1dFxuICAgICAgICAgICAgICB0eXBlPVwidGV4dFwiXG4gICAgICAgICAgICAgIG9uQ2hhbmdlPXt0aGlzLnNldEZvcm0oJ2F1dGhvcicpfVxuICAgICAgICAgICAgICB2YWx1ZT17Zm9ybURhdGEuYXV0aG9yfVxuICAgICAgICAgICAgICBwbGFjZWhvbGRlcj1cIkF1dGhvclwiIC8+XG4gICAgICAgICAgICA8YnV0dG9uIGRpc2FibGVkPXt0aGlzLmlzRm9ybUludmFsaWQoKX0+QWRkPC9idXR0b24+XG4gICAgICAgICAgPC9mb3JtPlxuICAgICAgICA8L2Rpdj5cbiAgICAgICAgPGgxPlxuICAgICAgICAgIFJlYWRpbmcgTGlzdFxuICAgICAgICA8L2gxPlxuICAgICAgICA8ZGl2IGlkPVwicmVhZGluZy1saXN0XCI+XG4gICAgICAgICAgPHVsPlxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICBsaXN0Lm1hcChib29rID0+IChcbiAgICAgICAgICAgICAgICA8ZGl2IGtleT17Ym9vay5faWR9PlxuICAgICAgICAgICAgICAgICAgPHNwYW4gY2xhc3NOYW1lPVwicmVtb3ZlXCIgb25DbGljaz17dGhpcy5yZW1vdmUoYm9vay5faWQpfT5cbiAgICAgICAgICAgICAgICAgICAgJnRpbWVzO1xuICAgICAgICAgICAgICAgICAgPC9zcGFuPiZuYnNwO1xuICAgICAgICAgICAgICAgICAgPHNwYW4gY2xhc3NOYW1lPVwiZGVzY3JpcHRpb25cIj5cbiAgICAgICAgICAgICAgICAgICAgPGk+e2Jvb2sudGl0bGV9PC9pPiBieSB7Ym9vay5hdXRob3J9XG4gICAgICAgICAgICAgICAgICA8L3NwYW4+XG4gICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICkpXG4gICAgICAgICAgICB9XG4gICAgICAgICAgPC91bD5cbiAgICAgICAgPC9kaXY+XG4gICAgICAgIDxzdHlsZSBqc3g+e2BcbiAgICAgICAgICBkaXYge1xuICAgICAgICAgICAgZm9udC1mYW1pbHk6ICdIZWx2ZXRpY2EnLCAnc2Fucy1zZXJpZic7XG4gICAgICAgICAgfVxuICAgICAgICAgICNjb250YWluZXIge1xuICAgICAgICAgICAgd2lkdGg6IDgwMHB4O1xuICAgICAgICAgICAgbWFyZ2luLWxlZnQ6IGF1dG87XG4gICAgICAgICAgICBtYXJnaW4tcmlnaHQ6IGF1dG87XG4gICAgICAgICAgfVxuICAgICAgICAgIGgxIHtcbiAgICAgICAgICAgIGNvbG9yOiAjY2NiYzFkO1xuICAgICAgICAgIH1cbiAgICAgICAgICBidXR0b24ge1xuICAgICAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogI2ZmMjU3YjtcbiAgICAgICAgICAgIGNvbG9yOiAjZmZmZmZmO1xuICAgICAgICAgICAgZm9udC13ZWlnaHQ6IGJvbGQ7XG4gICAgICAgICAgICBib3JkZXI6IDBweDtcbiAgICAgICAgICAgIGJvcmRlci1yYWRpdXM6IDJweDtcbiAgICAgICAgICAgIHBhZGRpbmc6IDVweDtcbiAgICAgICAgICAgIHBhZGRpbmctbGVmdDogOHB4O1xuICAgICAgICAgICAgcGFkZGluZy1yaWdodDogOHB4O1xuICAgICAgICAgICAgbWFyZ2luOiA1cHg7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlucHV0IHtcbiAgICAgICAgICAgIHBhZGRpbmc6IDVweDtcbiAgICAgICAgICAgIGJvcmRlcjogMHB4O1xuICAgICAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogI2YwZjBmMDtcbiAgICAgICAgICAgIG1hcmdpbjogNXB4O1xuICAgICAgICAgIH1cbiAgICAgICAgICAuZGVzY3JpcHRpb24ge1xuICAgICAgICAgICAgcG9zaXRpb246IHJlbGF0aXZlO1xuICAgICAgICAgICAgdG9wOiAtMC4yZW07XG4gICAgICAgICAgfVxuICAgICAgICAgIC5yZW1vdmUge1xuICAgICAgICAgICAgY3Vyc29yOiBwb2ludGVyO1xuICAgICAgICAgICAgY29sb3I6ICNmZjI1N2I7XG4gICAgICAgICAgICBmb250LXNpemU6IDEuNWVtO1xuICAgICAgICAgIH1cbiAgICAgICAgYH08L3N0eWxlPlxuICAgICAgPC9kaXY+XG4gICAgKVxuICB9XG59XG4iXX0= */\\n/*@ sourceURL=/Users/stefanfrancis/Personal/work/pakyo-backend/pages/index.js */\"));\n    }\n  }]);\n\n  return _default;\n}(React.Component);\n\nexport { _default as default };","map":{"version":3,"sources":["/Users/stefanfrancis/Personal/work/pakyo-backend/pages/index.js"],"names":["React","superagent","req","hostname","protocol","get","baseUrl","db","collection","find","sort","createdAt","toArray","list","then","res","body","state","formData","author","title","prop","ev","setState","target","value","_id","del","props","filter","book","error","console","stack","preventDefault","post","concat","add","setForm","isFormInvalid","map","remove","Component"],"mappings":";;;;;;;;;;AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,OAAO,KAAKC,UAAZ,MAA4B,YAA5B;;;;;;;;;;;;;;;;AAGkCC,cAAAA,G,QAAAA,G;AACxBC,cAAAA,Q,GAAWD,GAAG,aAAMA,GAAG,CAACE,QAAV,gBAAwBF,GAAG,CAACG,GAAJ,CAAQ,MAAR,CAAxB,IAA4C,E;AAC1DC,cAAAA,O,aAAaH,Q;;mBACfD,G;;;;;AACMK,cAAAA,E,GAAOL,G,CAAPK,E;;+CACWA,EAAE,CAACC,UAAH,CAAc,eAAd,EAA+BC,IAA/B,GAAsCC,IAAtC,CAA2C;AAAEC,gBAAAA,SAAS,EAAE,CAAC;AAAd,eAA3C,EAChBC,OADgB,E;;;AAAbC,cAAAA,K;+CAEC;AAAEA,gBAAAA,IAAI,EAAJA;AAAF,e;;;;+CAGcZ,UAAU,CAACI,GAAX,CAAeC,OAAf,EACpBQ,IADoB,CACf,UAAAC,GAAG;AAAA,uBAAIA,GAAG,CAACC,IAAR;AAAA,eADY,C;;;;AAAfH,cAAAA,I,SAAAA,I;+CAED;AAAEA,gBAAAA,IAAI,EAAJA,IAAF;AAAQP,gBAAAA,OAAO,EAAPA;AAAR,e;;;;;;;;;;;AAGT,sBAAe;AAAA;;AAAA;;AACb;AACA,UAAKW,KAAL,GAAa;AAAEC,MAAAA,QAAQ,EAAE;AAAEC,QAAAA,MAAM,EAAE,EAAV;AAAcC,QAAAA,KAAK,EAAE;AAArB;AAAZ,KAAb;AAFa;AAGd;;;;4BAEQC,I,EAAM;AAAA;;AACb,aAAO,UAAAC,EAAE,EAAI;AACX,YAAML,KAAK,GAAG,MAAI,CAACA,KAAL,IAAc,EAA5B;AACA,YAAMC,QAAQ,GAAGD,KAAK,CAACC,QAAN,IAAkB,EAAnC;;AACA,QAAA,MAAI,CAACK,QAAL,CAAc,eAAc,EAAd,EAAkBN,KAAlB,EAAyB;AACrCC,UAAAA,QAAQ,EAAE,eAAc,EAAd,EAAkBA,QAAlB,sBACPG,IADO,EACAC,EAAE,CAACE,MAAH,CAAUC,KADV;AAD2B,SAAzB,CAAd;AAKD,OARD;AASD;;;oCAEgB;AACf,UAAMR,KAAK,GAAG,KAAKA,KAAL,IAAc,EAA5B;AACA,UAAMC,QAAQ,GAAGD,KAAK,CAACC,QAAN,IAAkB,EAAnC;AACA,aAAO,CAACA,QAAQ,CAACC,MAAV,IAAoB,CAACD,QAAQ,CAACE,KAArC;AACD;;;2BAEOM,G,EAAK;AAAA;;AACX,aAAO,UAAAJ,EAAE,EAAI;AACXrB,QAAAA,UAAU,CAAC0B,GAAX,WAAkB,MAAI,CAACC,KAAL,CAAWtB,OAA7B,cAAwCoB,GAAxC,GACGZ,IADH,CACQ,YAAM;AACV,cAAMG,KAAK,GAAG,MAAI,CAACA,KAAL,IAAc,EAA5B;AACA,cAAMJ,IAAI,GAAG,MAAI,CAACI,KAAL,CAAWJ,IAAX,IAAmB,MAAI,CAACe,KAAL,CAAWf,IAA9B,IAAsC,EAAnD;;AACA,UAAA,MAAI,CAACU,QAAL,CAAc,eAAc,EAAd,EAAkBN,KAAlB,EAAyB;AACrCJ,YAAAA,IAAI,EAAEA,IAAI,CAACgB,MAAL,CAAY,UAAAC,IAAI;AAAA,qBAAIA,IAAI,CAACJ,GAAL,KAAaA,GAAjB;AAAA,aAAhB;AAD+B,WAAzB,CAAd;AAGD,SAPH,WAQS,UAAAK,KAAK;AAAA,iBAAIC,OAAO,CAACD,KAAR,CAAcA,KAAK,CAACE,KAApB,CAAJ;AAAA,SARd;AASD,OAVD;AAWD;;;0BAEM;AAAA;;AACL,aAAO,UAAAX,EAAE,EAAI;AACXA,QAAAA,EAAE,CAACY,cAAH;AACA,YAAMjB,KAAK,GAAG,MAAI,CAACA,KAAL,IAAc,EAA5B;AACA,YAAMC,QAAQ,GAAGD,KAAK,CAACC,QAAN,IAAkB,EAAnC;;AACA,QAAA,MAAI,CAACK,QAAL,CAAc,eAAc,EAAd,EAAkB,MAAI,CAACN,KAAvB,EAA8B;AAC1CC,UAAAA,QAAQ,EAAE;AAAEC,YAAAA,MAAM,EAAE,EAAV;AAAcC,YAAAA,KAAK,EAAE;AAArB;AADgC,SAA9B,CAAd;;AAIAnB,QAAAA,UAAU,CAACkC,IAAX,CAAgB,MAAI,CAACP,KAAL,CAAWtB,OAA3B,EAAoCY,QAApC,EACGJ,IADH,CACQ,UAAAC,GAAG,EAAI;AACX,cAAME,KAAK,GAAG,MAAI,CAACA,KAAL,IAAc,EAA5B;AACA,cAAMJ,IAAI,GAAG,MAAI,CAACI,KAAL,CAAWJ,IAAX,IAAmB,MAAI,CAACe,KAAL,CAAWf,IAA9B,IAAsC,EAAnD;;AACA,UAAA,MAAI,CAACU,QAAL,CAAc,eAAc,EAAd,EAAkBN,KAAlB,EAAyB;AACrCJ,YAAAA,IAAI,EAAE,CAACE,GAAG,CAACC,IAAJ,CAASc,IAAV,EAAgBM,MAAhB,CAAuBvB,IAAvB;AAD+B,WAAzB,CAAd;AAGD,SAPH,WAQS,UAAAkB,KAAK;AAAA,iBAAIC,OAAO,CAACD,KAAR,CAAcA,KAAK,CAACE,KAApB,CAAJ;AAAA,SARd;AASD,OAjBD;AAkBD;;;6BAES;AAAA;;AACR,UAAMpB,IAAI,GAAG,KAAKI,KAAL,CAAWJ,IAAX,IAAmB,KAAKe,KAAL,CAAWf,IAA3C;AADQ,UAEAK,QAFA,GAEa,KAAKD,KAFlB,CAEAC,QAFA;AAGR,aACE;AAAK,QAAA,EAAE,EAAC,WAAR;AAAA;AAAA,SACE;AAAA;AAAA,oBADF,EAIE;AAAK,QAAA,EAAE,EAAC,YAAR;AAAA;AAAA,SACE;AAAM,QAAA,QAAQ,EAAE,KAAKmB,GAAL,EAAhB;AAAA;AAAA,SACE;AACE,QAAA,IAAI,EAAC,MADP;AAEE,QAAA,QAAQ,EAAE,KAAKC,OAAL,CAAa,OAAb,CAFZ;AAGE,QAAA,KAAK,EAAEpB,QAAQ,CAACE,KAHlB;AAIE,QAAA,WAAW,EAAC,OAJd;AAAA;AAAA,QADF,EAME;AACE,QAAA,IAAI,EAAC,MADP;AAEE,QAAA,QAAQ,EAAE,KAAKkB,OAAL,CAAa,QAAb,CAFZ;AAGE,QAAA,KAAK,EAAEpB,QAAQ,CAACC,MAHlB;AAIE,QAAA,WAAW,EAAC,QAJd;AAAA;AAAA,QANF,EAWE;AAAQ,QAAA,QAAQ,EAAE,KAAKoB,aAAL,EAAlB;AAAA;AAAA,eAXF,CADF,CAJF,EAmBE;AAAA;AAAA,wBAnBF,EAsBE;AAAK,QAAA,EAAE,EAAC,cAAR;AAAA;AAAA,SACE;AAAA;AAAA,SAEI1B,IAAI,CAAC2B,GAAL,CAAS,UAAAV,IAAI;AAAA,eACX;AAAK,UAAA,GAAG,EAAEA,IAAI,CAACJ,GAAf;AAAA;AAAA,WACE;AAAyB,UAAA,OAAO,EAAE,MAAI,CAACe,MAAL,CAAYX,IAAI,CAACJ,GAAjB,CAAlC;AAAA,8CAAgB;AAAhB,kBADF,UAIE;AAAA,8CAAgB;AAAhB,WACE;AAAA;AAAA,WAAII,IAAI,CAACV,KAAT,CADF,UAC0BU,IAAI,CAACX,MAD/B,CAJF,CADW;AAAA,OAAb,CAFJ,CADF,CAtBF;AAAA;AAAA,siOADF;AAgFD;;;;EA7J0BnB,KAAK,CAAC0C,S","sourcesContent":["import React from 'react'\nimport * as superagent from 'superagent'\n\nexport default class extends React.Component {\n  static async getInitialProps ({ req }) {\n    const hostname = req ? `${req.protocol}://${req.get('Host')}` : '';\n    const baseUrl = `${hostname}/api`;\n    if (req) {\n      const { db } = req\n      const list = await db.collection('Registrations').find().sort({ createdAt: -1 })\n        .toArray()\n      return { list }\n    }\n\n    const { list } = await superagent.get(baseUrl)\n      .then(res => res.body)\n    return { list, baseUrl }\n  }\n\n  constructor () {\n    super()\n    this.state = { formData: { author: '', title: '' } }\n  }\n\n  setForm (prop) {\n    return ev => {\n      const state = this.state || {}\n      const formData = state.formData || {}\n      this.setState(Object.assign({}, state, {\n        formData: Object.assign({}, formData, {\n          [prop]: ev.target.value\n        })\n      }));\n    }\n  }\n\n  isFormInvalid () {\n    const state = this.state || {}\n    const formData = state.formData || {}\n    return !formData.author || !formData.title\n  }\n\n  remove (_id) {\n    return ev => {\n      superagent.del(`${this.props.baseUrl}/${_id}`)\n        .then(() => {\n          const state = this.state || {}\n          const list = this.state.list || this.props.list || []\n          this.setState(Object.assign({}, state, {\n            list: list.filter(book => book._id !== _id)\n          }))\n        })\n        .catch(error => console.error(error.stack))\n    }\n  }\n\n  add () {\n    return ev => {\n      ev.preventDefault()\n      const state = this.state || {}\n      const formData = state.formData || {}\n      this.setState(Object.assign({}, this.state, {\n        formData: { author: '', title: '' }\n      }))\n\n      superagent.post(this.props.baseUrl, formData)\n        .then(res => {\n          const state = this.state || {}\n          const list = this.state.list || this.props.list || []\n          this.setState(Object.assign({}, state, {\n            list: [res.body.book].concat(list)\n          }))\n        })\n        .catch(error => console.error(error.stack))\n    }\n  }\n\n  render () {\n    const list = this.state.list || this.props.list\n    const { formData } = this.state\n    return (\n      <div id=\"container\">\n        <h1>\n          New Book\n        </h1>\n        <div id=\"input-book\">\n          <form onSubmit={this.add()}>\n            <input\n              type=\"text\"\n              onChange={this.setForm('title')}\n              value={formData.title}\n              placeholder=\"Title\" />\n            <input\n              type=\"text\"\n              onChange={this.setForm('author')}\n              value={formData.author}\n              placeholder=\"Author\" />\n            <button disabled={this.isFormInvalid()}>Add</button>\n          </form>\n        </div>\n        <h1>\n          Reading List\n        </h1>\n        <div id=\"reading-list\">\n          <ul>\n            {\n              list.map(book => (\n                <div key={book._id}>\n                  <span className=\"remove\" onClick={this.remove(book._id)}>\n                    &times;\n                  </span>&nbsp;\n                  <span className=\"description\">\n                    <i>{book.title}</i> by {book.author}\n                  </span>\n                </div>\n              ))\n            }\n          </ul>\n        </div>\n        <style jsx>{`\n          div {\n            font-family: 'Helvetica', 'sans-serif';\n          }\n          #container {\n            width: 800px;\n            margin-left: auto;\n            margin-right: auto;\n          }\n          h1 {\n            color: #ccbc1d;\n          }\n          button {\n            background-color: #ff257b;\n            color: #ffffff;\n            font-weight: bold;\n            border: 0px;\n            border-radius: 2px;\n            padding: 5px;\n            padding-left: 8px;\n            padding-right: 8px;\n            margin: 5px;\n          }\n          input {\n            padding: 5px;\n            border: 0px;\n            background-color: #f0f0f0;\n            margin: 5px;\n          }\n          .description {\n            position: relative;\n            top: -0.2em;\n          }\n          .remove {\n            cursor: pointer;\n            color: #ff257b;\n            font-size: 1.5em;\n          }\n        `}</style>\n      </div>\n    )\n  }\n}\n"]},"metadata":{},"sourceType":"module"}