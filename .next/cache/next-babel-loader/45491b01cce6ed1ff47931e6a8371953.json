{"ast":null,"code":"import _JSXStyle from \"styled-jsx/style\";\nvar __jsx = React.createElement;\nimport React from 'react';\nimport * as superagent from 'superagent';\nexport default class extends React.Component {\n  static async getInitialProps({\n    req\n  }) {\n    const hostname = req ? `${req.protocol}://${req.get('Host')}` : '';\n    const baseUrl = `${hostname}/api`;\n\n    if (req) {\n      const {\n        db\n      } = req;\n      const list = await db.collection('Registrations').find().sort({\n        createdAt: -1\n      }).toArray();\n      return {\n        list\n      };\n    }\n\n    const {\n      list\n    } = await superagent.get(baseUrl).then(res => res.body);\n    return {\n      list\n    };\n  }\n\n  constructor() {\n    super();\n    this.state = {\n      formData: {\n        author: '',\n        title: ''\n      }\n    };\n  }\n\n  setForm(prop) {\n    return ev => {\n      const state = this.state || {};\n      const formData = state.formData || {};\n      this.setState(Object.assign({}, state, {\n        formData: Object.assign({}, formData, {\n          [prop]: ev.target.value\n        })\n      }));\n    };\n  }\n\n  isFormInvalid() {\n    const state = this.state || {};\n    const formData = state.formData || {};\n    return !formData.author || !formData.title;\n  }\n\n  remove(_id) {\n    return ev => {\n      superagent.del(`${baseUrl}/${_id}`).then(() => {\n        const state = this.state || {};\n        const list = this.state.list || this.props.list || [];\n        this.setState(Object.assign({}, state, {\n          list: list.filter(book => book._id !== _id)\n        }));\n      }).catch(error => console.error(error.stack));\n    };\n  }\n\n  add() {\n    return ev => {\n      ev.preventDefault();\n      const state = this.state || {};\n      const formData = state.formData || {};\n      this.setState(Object.assign({}, this.state, {\n        formData: {\n          author: '',\n          title: ''\n        }\n      }));\n      superagent.post(baseUrl, formData).then(res => {\n        const state = this.state || {};\n        const list = this.state.list || this.props.list || [];\n        this.setState(Object.assign({}, state, {\n          list: [res.body.book].concat(list)\n        }));\n      }).catch(error => console.error(error.stack));\n    };\n  }\n\n  render() {\n    const list = this.state.list || this.props.list;\n    const {\n      formData\n    } = this.state;\n    return __jsx(\"div\", {\n      id: \"container\",\n      className: \"jsx-2512804896\"\n    }, __jsx(\"h1\", {\n      className: \"jsx-2512804896\"\n    }, \"New Book\"), __jsx(\"div\", {\n      id: \"input-book\",\n      className: \"jsx-2512804896\"\n    }, __jsx(\"form\", {\n      onSubmit: this.add(),\n      className: \"jsx-2512804896\"\n    }, __jsx(\"input\", {\n      type: \"text\",\n      onChange: this.setForm('title'),\n      value: formData.title,\n      placeholder: \"Title\",\n      className: \"jsx-2512804896\"\n    }), __jsx(\"input\", {\n      type: \"text\",\n      onChange: this.setForm('author'),\n      value: formData.author,\n      placeholder: \"Author\",\n      className: \"jsx-2512804896\"\n    }), __jsx(\"button\", {\n      disabled: this.isFormInvalid(),\n      className: \"jsx-2512804896\"\n    }, \"Add\"))), __jsx(\"h1\", {\n      className: \"jsx-2512804896\"\n    }, \"Reading List\"), __jsx(\"div\", {\n      id: \"reading-list\",\n      className: \"jsx-2512804896\"\n    }, __jsx(\"ul\", {\n      className: \"jsx-2512804896\"\n    }, list.map(book => __jsx(\"div\", {\n      key: book._id,\n      className: \"jsx-2512804896\"\n    }, __jsx(\"span\", {\n      onClick: this.remove(book._id),\n      className: \"jsx-2512804896\" + \" \" + \"remove\"\n    }, \"\\xD7\"), \"\\xA0\", __jsx(\"span\", {\n      className: \"jsx-2512804896\" + \" \" + \"description\"\n    }, __jsx(\"i\", {\n      className: \"jsx-2512804896\"\n    }, book.title), \" by \", book.author))))), __jsx(_JSXStyle, {\n      id: \"2512804896\"\n    }, \"div.jsx-2512804896{font-family:'Helvetica','sans-serif';}#container.jsx-2512804896{width:800px;margin-left:auto;margin-right:auto;}h1.jsx-2512804896{color:#ccbc1d;}button.jsx-2512804896{background-color:#ff257b;color:#ffffff;font-weight:bold;border:0px;border-radius:2px;padding:5px;padding-left:8px;padding-right:8px;margin:5px;}input.jsx-2512804896{padding:5px;border:0px;background-color:#f0f0f0;margin:5px;}.description.jsx-2512804896{position:relative;top:-0.2em;}.remove.jsx-2512804896{cursor:pointer;color:#ff257b;font-size:1.5em;}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9zdGVmYW5mcmFuY2lzL1BlcnNvbmFsL3dvcmsvcGFreW8tYmFja2VuZC9wYWdlcy9pbmRleC5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUF1SG9CLEFBR21ELEFBRzFCLEFBS0UsQUFHVyxBQVdiLEFBTU0sQUFJSCxZQTVCRSxBQW1CTixFQWRiLENBd0JnQixHQUpILEtBTGMsRUFaWCxJQVBJLEFBeUJwQixBQUlrQixRQWpDbEIsRUFZbUIsTUFzQm5CLEVBN0JBLENBbUJhLFFBWEEsR0FZYixRQVhvQixrQkFDTixZQUNLLGlCQUNDLGtCQUNQLFdBQ2IiLCJmaWxlIjoiL1VzZXJzL3N0ZWZhbmZyYW5jaXMvUGVyc29uYWwvd29yay9wYWt5by1iYWNrZW5kL3BhZ2VzL2luZGV4LmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFJlYWN0IGZyb20gJ3JlYWN0J1xuaW1wb3J0ICogYXMgc3VwZXJhZ2VudCBmcm9tICdzdXBlcmFnZW50J1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBleHRlbmRzIFJlYWN0LkNvbXBvbmVudCB7XG4gIHN0YXRpYyBhc3luYyBnZXRJbml0aWFsUHJvcHMgKHsgcmVxIH0pIHtcbiAgICBjb25zdCBob3N0bmFtZSA9IHJlcSA/IGAke3JlcS5wcm90b2NvbH06Ly8ke3JlcS5nZXQoJ0hvc3QnKX1gIDogJyc7XG4gICAgY29uc3QgYmFzZVVybCA9IGAke2hvc3RuYW1lfS9hcGlgO1xuICAgIGlmIChyZXEpIHtcbiAgICAgIGNvbnN0IHsgZGIgfSA9IHJlcVxuICAgICAgY29uc3QgbGlzdCA9IGF3YWl0IGRiLmNvbGxlY3Rpb24oJ1JlZ2lzdHJhdGlvbnMnKS5maW5kKCkuc29ydCh7IGNyZWF0ZWRBdDogLTEgfSlcbiAgICAgICAgLnRvQXJyYXkoKVxuICAgICAgcmV0dXJuIHsgbGlzdCB9XG4gICAgfVxuXG4gICAgY29uc3QgeyBsaXN0IH0gPSBhd2FpdCBzdXBlcmFnZW50LmdldChiYXNlVXJsKVxuICAgICAgLnRoZW4ocmVzID0+IHJlcy5ib2R5KVxuICAgIHJldHVybiB7IGxpc3QgfVxuICB9XG5cbiAgY29uc3RydWN0b3IgKCkge1xuICAgIHN1cGVyKClcbiAgICB0aGlzLnN0YXRlID0geyBmb3JtRGF0YTogeyBhdXRob3I6ICcnLCB0aXRsZTogJycgfSB9XG4gIH1cblxuICBzZXRGb3JtIChwcm9wKSB7XG4gICAgcmV0dXJuIGV2ID0+IHtcbiAgICAgIGNvbnN0IHN0YXRlID0gdGhpcy5zdGF0ZSB8fCB7fVxuICAgICAgY29uc3QgZm9ybURhdGEgPSBzdGF0ZS5mb3JtRGF0YSB8fCB7fVxuICAgICAgdGhpcy5zZXRTdGF0ZShPYmplY3QuYXNzaWduKHt9LCBzdGF0ZSwge1xuICAgICAgICBmb3JtRGF0YTogT2JqZWN0LmFzc2lnbih7fSwgZm9ybURhdGEsIHtcbiAgICAgICAgICBbcHJvcF06IGV2LnRhcmdldC52YWx1ZVxuICAgICAgICB9KVxuICAgICAgfSkpO1xuICAgIH1cbiAgfVxuXG4gIGlzRm9ybUludmFsaWQgKCkge1xuICAgIGNvbnN0IHN0YXRlID0gdGhpcy5zdGF0ZSB8fCB7fVxuICAgIGNvbnN0IGZvcm1EYXRhID0gc3RhdGUuZm9ybURhdGEgfHwge31cbiAgICByZXR1cm4gIWZvcm1EYXRhLmF1dGhvciB8fCAhZm9ybURhdGEudGl0bGVcbiAgfVxuXG4gIHJlbW92ZSAoX2lkKSB7XG4gICAgcmV0dXJuIGV2ID0+IHtcbiAgICAgIHN1cGVyYWdlbnQuZGVsKGAke2Jhc2VVcmx9LyR7X2lkfWApXG4gICAgICAgIC50aGVuKCgpID0+IHtcbiAgICAgICAgICBjb25zdCBzdGF0ZSA9IHRoaXMuc3RhdGUgfHwge31cbiAgICAgICAgICBjb25zdCBsaXN0ID0gdGhpcy5zdGF0ZS5saXN0IHx8IHRoaXMucHJvcHMubGlzdCB8fCBbXVxuICAgICAgICAgIHRoaXMuc2V0U3RhdGUoT2JqZWN0LmFzc2lnbih7fSwgc3RhdGUsIHtcbiAgICAgICAgICAgIGxpc3Q6IGxpc3QuZmlsdGVyKGJvb2sgPT4gYm9vay5faWQgIT09IF9pZClcbiAgICAgICAgICB9KSlcbiAgICAgICAgfSlcbiAgICAgICAgLmNhdGNoKGVycm9yID0+IGNvbnNvbGUuZXJyb3IoZXJyb3Iuc3RhY2spKVxuICAgIH1cbiAgfVxuXG4gIGFkZCAoKSB7XG4gICAgcmV0dXJuIGV2ID0+IHtcbiAgICAgIGV2LnByZXZlbnREZWZhdWx0KClcbiAgICAgIGNvbnN0IHN0YXRlID0gdGhpcy5zdGF0ZSB8fCB7fVxuICAgICAgY29uc3QgZm9ybURhdGEgPSBzdGF0ZS5mb3JtRGF0YSB8fCB7fVxuICAgICAgdGhpcy5zZXRTdGF0ZShPYmplY3QuYXNzaWduKHt9LCB0aGlzLnN0YXRlLCB7XG4gICAgICAgIGZvcm1EYXRhOiB7IGF1dGhvcjogJycsIHRpdGxlOiAnJyB9XG4gICAgICB9KSlcblxuICAgICAgc3VwZXJhZ2VudC5wb3N0KGJhc2VVcmwsIGZvcm1EYXRhKVxuICAgICAgICAudGhlbihyZXMgPT4ge1xuICAgICAgICAgIGNvbnN0IHN0YXRlID0gdGhpcy5zdGF0ZSB8fCB7fVxuICAgICAgICAgIGNvbnN0IGxpc3QgPSB0aGlzLnN0YXRlLmxpc3QgfHwgdGhpcy5wcm9wcy5saXN0IHx8IFtdXG4gICAgICAgICAgdGhpcy5zZXRTdGF0ZShPYmplY3QuYXNzaWduKHt9LCBzdGF0ZSwge1xuICAgICAgICAgICAgbGlzdDogW3Jlcy5ib2R5LmJvb2tdLmNvbmNhdChsaXN0KVxuICAgICAgICAgIH0pKVxuICAgICAgICB9KVxuICAgICAgICAuY2F0Y2goZXJyb3IgPT4gY29uc29sZS5lcnJvcihlcnJvci5zdGFjaykpXG4gICAgfVxuICB9XG5cbiAgcmVuZGVyICgpIHtcbiAgICBjb25zdCBsaXN0ID0gdGhpcy5zdGF0ZS5saXN0IHx8IHRoaXMucHJvcHMubGlzdFxuICAgIGNvbnN0IHsgZm9ybURhdGEgfSA9IHRoaXMuc3RhdGVcbiAgICByZXR1cm4gKFxuICAgICAgPGRpdiBpZD1cImNvbnRhaW5lclwiPlxuICAgICAgICA8aDE+XG4gICAgICAgICAgTmV3IEJvb2tcbiAgICAgICAgPC9oMT5cbiAgICAgICAgPGRpdiBpZD1cImlucHV0LWJvb2tcIj5cbiAgICAgICAgICA8Zm9ybSBvblN1Ym1pdD17dGhpcy5hZGQoKX0+XG4gICAgICAgICAgICA8aW5wdXRcbiAgICAgICAgICAgICAgdHlwZT1cInRleHRcIlxuICAgICAgICAgICAgICBvbkNoYW5nZT17dGhpcy5zZXRGb3JtKCd0aXRsZScpfVxuICAgICAgICAgICAgICB2YWx1ZT17Zm9ybURhdGEudGl0bGV9XG4gICAgICAgICAgICAgIHBsYWNlaG9sZGVyPVwiVGl0bGVcIiAvPlxuICAgICAgICAgICAgPGlucHV0XG4gICAgICAgICAgICAgIHR5cGU9XCJ0ZXh0XCJcbiAgICAgICAgICAgICAgb25DaGFuZ2U9e3RoaXMuc2V0Rm9ybSgnYXV0aG9yJyl9XG4gICAgICAgICAgICAgIHZhbHVlPXtmb3JtRGF0YS5hdXRob3J9XG4gICAgICAgICAgICAgIHBsYWNlaG9sZGVyPVwiQXV0aG9yXCIgLz5cbiAgICAgICAgICAgIDxidXR0b24gZGlzYWJsZWQ9e3RoaXMuaXNGb3JtSW52YWxpZCgpfT5BZGQ8L2J1dHRvbj5cbiAgICAgICAgICA8L2Zvcm0+XG4gICAgICAgIDwvZGl2PlxuICAgICAgICA8aDE+XG4gICAgICAgICAgUmVhZGluZyBMaXN0XG4gICAgICAgIDwvaDE+XG4gICAgICAgIDxkaXYgaWQ9XCJyZWFkaW5nLWxpc3RcIj5cbiAgICAgICAgICA8dWw+XG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgIGxpc3QubWFwKGJvb2sgPT4gKFxuICAgICAgICAgICAgICAgIDxkaXYga2V5PXtib29rLl9pZH0+XG4gICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzc05hbWU9XCJyZW1vdmVcIiBvbkNsaWNrPXt0aGlzLnJlbW92ZShib29rLl9pZCl9PlxuICAgICAgICAgICAgICAgICAgICAmdGltZXM7XG4gICAgICAgICAgICAgICAgICA8L3NwYW4+Jm5ic3A7XG4gICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzc05hbWU9XCJkZXNjcmlwdGlvblwiPlxuICAgICAgICAgICAgICAgICAgICA8aT57Ym9vay50aXRsZX08L2k+IGJ5IHtib29rLmF1dGhvcn1cbiAgICAgICAgICAgICAgICAgIDwvc3Bhbj5cbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgKSlcbiAgICAgICAgICAgIH1cbiAgICAgICAgICA8L3VsPlxuICAgICAgICA8L2Rpdj5cbiAgICAgICAgPHN0eWxlIGpzeD57YFxuICAgICAgICAgIGRpdiB7XG4gICAgICAgICAgICBmb250LWZhbWlseTogJ0hlbHZldGljYScsICdzYW5zLXNlcmlmJztcbiAgICAgICAgICB9XG4gICAgICAgICAgI2NvbnRhaW5lciB7XG4gICAgICAgICAgICB3aWR0aDogODAwcHg7XG4gICAgICAgICAgICBtYXJnaW4tbGVmdDogYXV0bztcbiAgICAgICAgICAgIG1hcmdpbi1yaWdodDogYXV0bztcbiAgICAgICAgICB9XG4gICAgICAgICAgaDEge1xuICAgICAgICAgICAgY29sb3I6ICNjY2JjMWQ7XG4gICAgICAgICAgfVxuICAgICAgICAgIGJ1dHRvbiB7XG4gICAgICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjZmYyNTdiO1xuICAgICAgICAgICAgY29sb3I6ICNmZmZmZmY7XG4gICAgICAgICAgICBmb250LXdlaWdodDogYm9sZDtcbiAgICAgICAgICAgIGJvcmRlcjogMHB4O1xuICAgICAgICAgICAgYm9yZGVyLXJhZGl1czogMnB4O1xuICAgICAgICAgICAgcGFkZGluZzogNXB4O1xuICAgICAgICAgICAgcGFkZGluZy1sZWZ0OiA4cHg7XG4gICAgICAgICAgICBwYWRkaW5nLXJpZ2h0OiA4cHg7XG4gICAgICAgICAgICBtYXJnaW46IDVweDtcbiAgICAgICAgICB9XG4gICAgICAgICAgaW5wdXQge1xuICAgICAgICAgICAgcGFkZGluZzogNXB4O1xuICAgICAgICAgICAgYm9yZGVyOiAwcHg7XG4gICAgICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjZjBmMGYwO1xuICAgICAgICAgICAgbWFyZ2luOiA1cHg7XG4gICAgICAgICAgfVxuICAgICAgICAgIC5kZXNjcmlwdGlvbiB7XG4gICAgICAgICAgICBwb3NpdGlvbjogcmVsYXRpdmU7XG4gICAgICAgICAgICB0b3A6IC0wLjJlbTtcbiAgICAgICAgICB9XG4gICAgICAgICAgLnJlbW92ZSB7XG4gICAgICAgICAgICBjdXJzb3I6IHBvaW50ZXI7XG4gICAgICAgICAgICBjb2xvcjogI2ZmMjU3YjtcbiAgICAgICAgICAgIGZvbnQtc2l6ZTogMS41ZW07XG4gICAgICAgICAgfVxuICAgICAgICBgfTwvc3R5bGU+XG4gICAgICA8L2Rpdj5cbiAgICApXG4gIH1cbn1cbiJdfQ== */\\n/*@ sourceURL=/Users/stefanfrancis/Personal/work/pakyo-backend/pages/index.js */\"));\n  }\n\n}","map":{"version":3,"sources":["/Users/stefanfrancis/Personal/work/pakyo-backend/pages/index.js"],"names":["React","superagent","Component","getInitialProps","req","hostname","protocol","get","baseUrl","db","list","collection","find","sort","createdAt","toArray","then","res","body","constructor","state","formData","author","title","setForm","prop","ev","setState","Object","assign","target","value","isFormInvalid","remove","_id","del","props","filter","book","catch","error","console","stack","add","preventDefault","post","concat","render","map"],"mappings":"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","sourcesContent":["import React from 'react'\nimport * as superagent from 'superagent'\n\nexport default class extends React.Component {\n  static async getInitialProps ({ req }) {\n    const hostname = req ? `${req.protocol}://${req.get('Host')}` : '';\n    const baseUrl = `${hostname}/api`;\n    if (req) {\n      const { db } = req\n      const list = await db.collection('Registrations').find().sort({ createdAt: -1 })\n        .toArray()\n      return { list }\n    }\n\n    const { list } = await superagent.get(baseUrl)\n      .then(res => res.body)\n    return { list }\n  }\n\n  constructor () {\n    super()\n    this.state = { formData: { author: '', title: '' } }\n  }\n\n  setForm (prop) {\n    return ev => {\n      const state = this.state || {}\n      const formData = state.formData || {}\n      this.setState(Object.assign({}, state, {\n        formData: Object.assign({}, formData, {\n          [prop]: ev.target.value\n        })\n      }));\n    }\n  }\n\n  isFormInvalid () {\n    const state = this.state || {}\n    const formData = state.formData || {}\n    return !formData.author || !formData.title\n  }\n\n  remove (_id) {\n    return ev => {\n      superagent.del(`${baseUrl}/${_id}`)\n        .then(() => {\n          const state = this.state || {}\n          const list = this.state.list || this.props.list || []\n          this.setState(Object.assign({}, state, {\n            list: list.filter(book => book._id !== _id)\n          }))\n        })\n        .catch(error => console.error(error.stack))\n    }\n  }\n\n  add () {\n    return ev => {\n      ev.preventDefault()\n      const state = this.state || {}\n      const formData = state.formData || {}\n      this.setState(Object.assign({}, this.state, {\n        formData: { author: '', title: '' }\n      }))\n\n      superagent.post(baseUrl, formData)\n        .then(res => {\n          const state = this.state || {}\n          const list = this.state.list || this.props.list || []\n          this.setState(Object.assign({}, state, {\n            list: [res.body.book].concat(list)\n          }))\n        })\n        .catch(error => console.error(error.stack))\n    }\n  }\n\n  render () {\n    const list = this.state.list || this.props.list\n    const { formData } = this.state\n    return (\n      <div id=\"container\">\n        <h1>\n          New Book\n        </h1>\n        <div id=\"input-book\">\n          <form onSubmit={this.add()}>\n            <input\n              type=\"text\"\n              onChange={this.setForm('title')}\n              value={formData.title}\n              placeholder=\"Title\" />\n            <input\n              type=\"text\"\n              onChange={this.setForm('author')}\n              value={formData.author}\n              placeholder=\"Author\" />\n            <button disabled={this.isFormInvalid()}>Add</button>\n          </form>\n        </div>\n        <h1>\n          Reading List\n        </h1>\n        <div id=\"reading-list\">\n          <ul>\n            {\n              list.map(book => (\n                <div key={book._id}>\n                  <span className=\"remove\" onClick={this.remove(book._id)}>\n                    &times;\n                  </span>&nbsp;\n                  <span className=\"description\">\n                    <i>{book.title}</i> by {book.author}\n                  </span>\n                </div>\n              ))\n            }\n          </ul>\n        </div>\n        <style jsx>{`\n          div {\n            font-family: 'Helvetica', 'sans-serif';\n          }\n          #container {\n            width: 800px;\n            margin-left: auto;\n            margin-right: auto;\n          }\n          h1 {\n            color: #ccbc1d;\n          }\n          button {\n            background-color: #ff257b;\n            color: #ffffff;\n            font-weight: bold;\n            border: 0px;\n            border-radius: 2px;\n            padding: 5px;\n            padding-left: 8px;\n            padding-right: 8px;\n            margin: 5px;\n          }\n          input {\n            padding: 5px;\n            border: 0px;\n            background-color: #f0f0f0;\n            margin: 5px;\n          }\n          .description {\n            position: relative;\n            top: -0.2em;\n          }\n          .remove {\n            cursor: pointer;\n            color: #ff257b;\n            font-size: 1.5em;\n          }\n        `}</style>\n      </div>\n    )\n  }\n}\n"]},"metadata":{},"sourceType":"module"}